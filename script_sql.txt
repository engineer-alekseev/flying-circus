CREATE TYPE user_role AS ENUM ('admin', 'user');

CREATE TABLE users (
  "id" SERIAL PRIMARY KEY NOT NULL,
  "name" VARCHAR(255) NOT NULL,
  "email" VARCHAR(255) UNIQUE,
  "role" user_role DEFAULT 'user',
  "telegram_id" VARCHAR(255) UNIQUE
);

CREATE TABLE rooms (
  "id" SERIAL PRIMARY KEY,
  "name" VARCHAR(255) UNIQUE,
  "capacity" INTEGER NOT NULL,
  "location" VARCHAR(255) NOT NULL,
  "min_time" INTEGER NOT NULL,
  "max_time" INTEGER NOT NULL,
  "photo_link" VARCHAR(255) NOT NULL
);
-- this table should be in ram, not in postgres.
CREATE TABLE bookings (
  "id" SERIAL PRIMARY KEY,
  "start_time" TIMESTAMP NOT NULL,
  "end_time" TIMESTAMP NOT NULL,
  "user_id" INTEGER NOT NULL,
  "room_id" INTEGER NOT NULL,
  FOREIGN KEY (user_id) REFERENCES users(id),
  FOREIGN KEY (room_id) REFERENCES rooms(id)
);

CREATE TABLE violations (
  "id" SERIAL PRIMARY KEY,
  "violation_type" VARCHAR(255) NOT NULL,
  "description" VARCHAR(255) NOT NULL,
  "user_id" INTEGER NOT NULL,
  "booking_id" INTEGER NOT NULL,
  FOREIGN KEY (user_id) REFERENCES users(id),
  FOREIGN KEY (booking_id) REFERENCES bookings(id)
);

